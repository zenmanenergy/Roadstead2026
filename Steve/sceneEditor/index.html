<!DOCTYPE html>
<html>
    <head>
        <title>Scene Editor</title>
        <link rel="stylesheet" href="style.css">
    </head>
<body>
    <div id="editor">
        <div id="toolbar">
            <select id="sceneSelect" onchange="loadScene(this.value)">
                <option value="">-- Select Scene --</option>
            </select>
            <button onclick="clearPolygons()" class="btn-danger">Clear All</button>
            <span id="filename" style="padding: 8px 12px; color: #aaa; font-size: 12px; margin-left: auto;">absnormal/data/[scenename].json</span>
        </div>

        <div id="workspace">
            <canvas id="canvas" width="800" height="600"></canvas>
            <div class="panel">
                <!-- Tab Bar -->
                <div class="tab-bar">
                    <button class="tab-button active" data-tab="walkable">Walkable Areas</button>
                    <button class="tab-button" data-tab="door">Doors</button>
                    <button class="tab-button" data-tab="npc">NPCs</button>
                    <button class="tab-button" data-tab="start">Start Point</button>
                    <button class="tab-button" data-tab="images">Images</button>
                </div>

                <!-- Tab Content -->
                <div class="tab-panel-container">
                    <div class="tab-panel active" id="tab-walkable">
                        <h3>Walkable Areas</h3>
                        <p class="hint">Click on canvas to place points. Finish polygon when done.</p>
                        <button onclick="finishPolygon()" class="btn-primary">Finish Polygon</button>
                        <button onclick="undoLastPoint()" class="btn-secondary">Undo Point</button>
                        
                        <div id="walkableListContainer" style="margin-top: 16px; display: none;">
                            <h4 style="margin: 0 0 8px 0; color: #cccccc; font-size: 13px;">Existing Walkable Areas:</h4>
                            <div id="walkableList" style="max-height: 200px; overflow-y: auto; border: 1px solid #3e3e42; border-radius: 3px; background: #1e1e1e; padding: 8px;"></div>
                        </div>
                    </div>

                    <div class="tab-panel" id="tab-door">
                        <h3>Doors</h3>
                        <p class="hint">Click on canvas to place door points. Select next scene for this door.</p>
                        <div class="form-group">
                            <label>Next Scene:</label>
                            <select id="doorNextScene">
                                <option value="">-- Select Scene --</option>
                                <option value="bedroom">Bedroom</option>
                                <option value="city">City</option>
                                <option value="doctor">Doctor</option>
                                <option value="pharmacy">Pharmacy</option>
                                <option value="lab">Lab</option>
                            </select>
                        </div>
                        <button onclick="finishPolygon()" class="btn-primary">Finish Door</button>
                        <button onclick="undoLastPoint()" class="btn-secondary">Undo Point</button>
                        
                        <div id="doorsListContainer" style="margin-top: 16px; display: none;">
                            <h4 style="margin: 0 0 8px 0; color: #cccccc; font-size: 13px;">Existing Doors:</h4>
                            <div id="doorsList" style="max-height: 200px; overflow-y: auto; border: 1px solid #3e3e42; border-radius: 3px; background: #1e1e1e; padding: 8px;">dsfgfdsgfdsgfdsfdgfd</div>
                        </div>
                    </div>

                    <div class="tab-panel" id="tab-npc">
                        <h3>NPCs</h3>
                        <p class="hint">Add NPC info then click canvas to place.</p>
                        <div class="form-group">
                            <label>NPC Name:</label>
                            <input type="text" id="npcName" placeholder="e.g., Doctor, Guard...">
                        </div>
                        <div class="form-group">
                            <label>NPC Type:</label>
                            <select id="npcType">
                                <option value="">-- Select Type --</option>
                                <option value="doctor">Doctor</option>
                                <option value="guard">Guard</option>
                                <option value="npc">Generic NPC</option>
                            </select>
                        </div>
                        <button onclick="addNPC()" class="btn-primary">Add NPC</button>
                        
                        <div id="npcsListContainer" style="margin-top: 16px; display: none;">
                            <h4 style="margin: 0 0 8px 0; color: #cccccc; font-size: 13px;">Existing NPCs:</h4>
                            <div id="npcsList" style="max-height: 200px; overflow-y: auto; border: 1px solid #3e3e42; border-radius: 3px; background: #1e1e1e; padding: 8px;"></div>
                        </div>
                    </div>

                    <div class="tab-panel" id="tab-start">
                        <h3>Start Point</h3>
                        <p class="hint">Click on canvas to set player starting position.</p>
                        <button onclick="clearStartPoint()" class="btn-secondary">Clear Start Point</button>
                    </div>

                    <div class="tab-panel" id="tab-images">
                        <h3>Background Images</h3>
                        <p class="hint">Select a background image to load on canvas.</p>
                        <div class="form-group">
                            <label>Available Images:</label>
                            <select id="backgroundImageSelect" onchange="changeBackgroundImage(this.value)">
                                <option value="">-- Select Image --</option>
                            </select>
                        </div>
                    </div>

                    <!-- JSON Output -->
                    <div class="json-output">
                        <h3>JSON Output</h3>
                        <textarea id="output" readonly placeholder="JSON will appear here..."></textarea>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="walkableAreas.js"></script>
    <script src="doors.js"></script>
    <script src="npcs.js"></script>
    <script src="startPoint.js"></script>
    <script src="images.js"></script>
    <script src="editor.js"></script>
</body>
</html>
